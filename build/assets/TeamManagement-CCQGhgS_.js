import{j as e,b as a}from"./index-D4td_YMW.js";import{r as t}from"./vendor-bXYm9Nr0.js";import{x as s,t as r,I as l,T as i,S as d,X as n}from"./ui-ByK4YB5C.js";const c=()=>{const[d,n]=t.useState([]),[c,m]=t.useState(!1),[x,g]=t.useState(null),[u,b]=t.useState(!1),[h,p]=t.useState(null),[y,j]=t.useState({email:"",firstName:"",lastName:"",role:"agent"}),[N,f]=t.useState(null);t.useEffect(()=>{try{v()}catch(e){p({type:"error",text:"Failed to load team members."}),n([])}},[]);const v=async()=>{try{const e=localStorage.getItem("teamMembers");e&&n(JSON.parse(e))}catch(e){}},k=e=>{localStorage.setItem("teamMembers",JSON.stringify(e)),n(e)},w=e=>{const a=d.map(a=>a.id===e.id?e:a);k(a),g(null),p({type:"success",text:`Permissions updated for ${e.email}`})},C=e=>{switch(e){case"admin":return"bg-red-100 text-red-800";case"manager":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Team Management"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Create and manage team members and their permissions"})]}),e.jsxs("button",{onClick:()=>m(!c),className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition",children:[e.jsx(s,{size:20}),"Add Team Member"]})]}),h&&e.jsx("div",{className:"p-4 rounded-lg "+("success"===h.type?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:h.text}),c&&e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 border border-gray-200 dark:border-slate-700",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Create New Team Member"}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),b(!0),p(null);try{if(!y.email||!y.firstName||!y.lastName)throw new Error("All fields are required");const e=await a.createUser(y.email,y.firstName,y.lastName,y.role);if(!e.success)throw new Error(e.error||"Failed to create user");{const a={id:e.user?.id||`user-${Date.now()}`,email:y.email,firstName:y.firstName,lastName:y.lastName,role:y.role,permissions:{viewProspects:!0,makeCalls:!0,viewCallHistory:!0,viewReports:"agent"!==y.role,manageTeam:"admin"===y.role,editSettings:"admin"===y.role||"manager"===y.role},createdAt:(new Date).toISOString()};k([...d,a]),p({type:"success",text:`User ${y.email} created successfully! Default password: ${y.email.split("@")[0]}123`}),j({email:"",firstName:"",lastName:"",role:"agent"}),m(!1)}}catch(t){p({type:"error",text:t instanceof Error?t.message:"Failed to create user"})}finally{b(!1)}},className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"First Name"}),e.jsx("input",{type:"text",value:y.firstName,onChange:e=>j({...y,firstName:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Last Name"}),e.jsx("input",{type:"text",value:y.lastName,onChange:e=>j({...y,lastName:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-white",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:y.email,onChange:e=>j({...y,email:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Role"}),e.jsxs("select",{value:y.role,onChange:e=>j({...y,role:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-white",children:[e.jsx("option",{value:"agent",children:"Agent"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",disabled:u,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg transition disabled:opacity-50",children:u?"Creating...":"Create User"}),e.jsx("button",{type:"button",onClick:()=>m(!1),className:"flex-1 bg-gray-300 dark:bg-slate-600 text-gray-900 dark:text-white py-2 rounded-lg hover:bg-gray-400 transition",children:"Cancel"})]})]})]}),e.jsx("div",{className:"grid gap-4",children:0!==d.length||h?d.map(a=>e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-6 border border-gray-200 dark:border-slate-700",children:x===a.id?e.jsx(o,{member:N,onSave:w,onCancel:()=>g(null)}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-gray-900 dark:text-white",children:[a.firstName," ",a.lastName]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.email})]})}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${C(a.role)}`,children:a.role.charAt(0).toUpperCase()+a.role.slice(1)}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Created ",new Date(a.createdAt).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{f(a),g(a.id)},className:"p-2 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900 rounded-lg transition",title:"Edit permissions",children:e.jsx(l,{size:18})}),e.jsx("button",{onClick:()=>(e=>{if(confirm("Are you sure you want to delete this user?")){const a=d.filter(a=>a.id!==e);k(a),p({type:"success",text:"User deleted successfully"})}})(a.id),className:"p-2 text-red-600 hover:bg-red-100 dark:hover:bg-red-900 rounded-lg transition",title:"Delete user",children:e.jsx(i,{size:18})})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:Object.entries(a.permissions).map(([a,t])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded "+(t?"bg-green-500":"bg-gray-300")}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim()})]},a))})]})},a.id)):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(r,{className:"mx-auto text-gray-400 mb-4",size:48}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No team members yet. Create one to get started."})]})})]})},o=({member:a,onSave:s,onCancel:r})=>{const[l,i]=t.useState(a);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Role"}),e.jsxs("select",{value:l.role,onChange:e=>{return a=e.target.value,void i({...l,role:a,permissions:{viewProspects:!0,makeCalls:!0,viewCallHistory:!0,viewReports:"agent"!==a,manageTeam:"admin"===a,editSettings:"admin"===a||"manager"===a}});var a},className:"w-full px-4 py-2 border border-gray-300 dark:border-slate-600 rounded-lg dark:bg-slate-700 dark:text-white",children:[e.jsx("option",{value:"agent",children:"Agent"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Permissions"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(l.permissions).map(([a,t])=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:()=>(e=>{i({...l,permissions:{...l.permissions,[e]:!l.permissions[e]}})})(a),className:"w-4 h-4 rounded"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase()).trim()})]},a))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>s(l),className:"flex-1 flex items-center justify-center gap-2 bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg transition",children:[e.jsx(d,{size:18}),"Save Changes"]}),e.jsxs("button",{onClick:r,className:"flex-1 flex items-center justify-center gap-2 bg-gray-300 dark:bg-slate-600 text-gray-900 dark:text-white py-2 rounded-lg hover:bg-gray-400 transition",children:[e.jsx(n,{size:18}),"Cancel"]})]})]})};export{c as TeamManagement};
